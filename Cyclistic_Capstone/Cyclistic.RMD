---
title: "Analysis of Cyclistic's Casual Riders vs Annual Members (In Progress)"
author: "Muhaimin Ahmed"
date: "August 28, 2024"
output: 
  github_document: default
---

# Introduction

## About Cyclistic

Cyclistic is a bike-share program that features more than 5,800 bicycles and 600 docking stations. The director of marketing believes the companyâ€™s future success depends on maximizing the number of annual memberships. Therefore, I want to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, I will design a new marketing strategy to convert casual riders into annual members.

## Guiding Questions

The questions guiding this analysis are the following: 1. How do annual members and casual riders use Cyclistic bikes differently? 2. Why would casual riders buy Cyclistic annual memberships? 3. How can Cyclistic use digital media to influence casual riders to become members?

## Location of the Data

The data used for this analysis is located [here](https://divvy-tripdata.s3.amazonaws.com/index.html). From the available data the 12 most recent months have been chosen for analysis (August 2023 to August 2024).

## Business Task

Identify potential opportunities for growth and recommendations for the Cyclistic marketing strategy to convert more casual riders to become members.

# Preparing the Data

## Libraries

These are the libraries that are used to complete this case study.

```{r adding libraries}
library(tidyverse)
library(dplyr)
library(readr)
library(lubridate)
library(ggplot2)
```

## Merging the Data

12 months of data are merged onto one data frame named cyclistic_df.

```{r load data and merge onto one df}
# temp <- list.files("./Cyclistic_Data", full.names = TRUE, pattern = "\\.csv$")
# 
# cyclistic_df <- readr::read_csv(temp, id = "Bike_Rides_2306_to_2407")
# 
# write.csv(cyclistic_df, "./Cyclistic_Data/cyclistic_merged_data.csv")

cyclistic_df <- readr::read_csv("./Cyclistic_Data/cyclistic_merged_data.csv")
```

Let's focus on the following columns to start the analysis:

-   ride_id: Ride unique ID.
-   member_casual: Cyclistic member or casual rider.
-   started_at and ended_at: Ride start and end times.
-   rideable_type: Electric, classic or docked bike.

```{r selecting start and stop times}
cyclistic_df_v2 <- select(cyclistic_df, ride_id, member_casual, started_at, ended_at, rideable_type)
head(cyclistic_df_v2)
```

## Checking for Missing Values

```{r}
sum(is.na(cyclistic_df_v2))
```

The data is complete for the columns of interest.

# Summarizing the Data

Using the selected fields the ride length can be calculated and the day of the week can also be determined and store in cyclistic_df_v2. I am also adding a month year column and sorting it chronologically for later use.

```{r add ride length and day of the week}
cyclistic_df_v3 <- mutate(cyclistic_df_v2, 
                          ride_lengths = abs(seconds_to_period(ended_at-started_at)), 
                          day_of_week = weekdays(started_at), 
                          month_year = format(started_at, "%b-%y")
                          ) %>%
  arrange(started_at) %>%  # Arrange the data by the original date-time column
  mutate(
    month_year = factor(month_year, levels = unique(month_year), ordered = TRUE)
  )
head(cyclistic_df_v3)
```

# Analyzing the data

```{r max ride length}
max(cyclistic_df_v3$ride_lengths)
```

```{r mean ride length}
mean(cyclistic_df_v3$ride_lengths)
```

```{r mode day of week and  rideable type}
mode_char <- function(x) unique(x)[which.max(tabulate(match(x, unique(x))))]
mode_char(cyclistic_df_v3$day_of_week)
mode_char(cyclistic_df_v3$rideable_type)
```

```{r average ride length for member and casual riders}
cyclistic_df_v3 %>%
  group_by(member_casual) %>%
  summarize(avg_ride_length = mean(ride_lengths, na.rm = TRUE))
```

We can conclude the following so far:

-   The longer ride was about an hour.
-   Average ride taking approximately 30 minutes.
-   Saturday is the most popular day for all users to ride bikes.
-   Electric bikes are more used than classic bikes.
-   On average there is no significant difference between casual and member users for ride length.

## Further Summarizing the Data

```{r distribution of bike types used by member and casual riders}

bike_type_by_member <- cyclistic_df_v3 %>%
  group_by(member_casual, rideable_type) %>%
  summarise(count = n()) %>%
  pivot_wider(names_from = rideable_type, values_from = count, values_fill = 0) %>%
  gather(key = "bike_type", value = "count", -member_casual)
head(bike_type_by_member)
```

# Visualization

```{r}
ggplot(bike_type_by_member, aes(x = member_casual, y = count, fill = bike_type)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Distribution of Bike Types by Member Type",
       x = "Member Type",
       y = "Count",
       fill = "Bike Type") + 
  theme(plot.title = element_text(hjust = 0.5))
```

We can see that there are already much more member users than there are casual users. However, both casual and member users use the classic and electric bikes relatively equally. This may mean that it is based on availability over preference. However more data is required to derive further conclusions from this graph.

```{r average ride length and number of rides for users by day of week}
summarized_cyclistic_data <- cyclistic_df_v3 %>%
  group_by(day_of_week, member_casual) %>%
  summarize(avg_ride_length = mean(ride_lengths), 
            num_rides = n())
```

```{r}
summarized_cyclistic_data$day_of_week <- factor(summarized_cyclistic_data$day_of_week, c("Monday", "Tuesday", "Wednesday", "Thursday","Friday","Saturday", "Sunday"))
```

```{r}
head(summarized_cyclistic_data)
```

```{r average ride length for users by day of week}
ggplot(data = summarized_cyclistic_data, aes(x = day_of_week, y = avg_ride_length, fill = member_casual)) +
  geom_bar(position = "dodge", stat = "identity") +
  labs(title = "Average Ride Length for Users by Day of the Week",
       x = "Day of the week",
       y = "Average Ride Length",
       fill = "User Type") + 
  theme(plot.title = element_text(hjust = 0.5))
```

As discussed before there is no significant difference in ride length between casual and member users. This graph clarifies this further by showing the it fluctuates very little throught the week.

```{r number of rides for users by day of week}
ggplot(data = summarized_cyclistic_data, aes(x = day_of_week, y = num_rides, fill = member_casual)) +
  geom_bar(position = "dodge", stat = "identity") +
  labs(title = "Number of Rides for Users by Day of the Week",
       x = "Day of the week",
       y = "Number of Rides",
       fill = "User Type") + 
  theme(plot.title = element_text(hjust = 0.5))
```

This graph shows that more member users ride during the week than in the weekend and there are more casual rider trips during the weekend. This means that member users use the service to commute to work while casual users use it leisurely on the weekend. Also as it was seen in the first graph, even though there are more casual riders in the weekend it is still less than the number of member users.

```{r monthly summary}
monthly_cyclistic_data <- cyclistic_df_v3 %>%
  group_by(month_year, member_casual) %>%
  summarize(avg_ride_length = mean(ride_lengths), 
            num_rides = n())

head(monthly_cyclistic_data)
```

```{r number of rides for users by month}
ggplot(data = monthly_cyclistic_data, aes(x = month_year, y = num_rides, fill = member_casual)) +
  geom_bar(position = "dodge", stat = "identity") +
  labs(title = "Number of Rides for Users by Month",
       x = "Month and Year",
       y = "Number of Rides",
       fill = "User Type") + 
  theme(plot.title = element_text(hjust = 0.5), 
        axis.text.x = element_text(angle = 45, size = 8))
```

I was also curious to see the number of rides throughout a year. And unsurprisingly there are more rides in the warmer months than there are in the colder months. Casual riders drop off much more than the member users. Once again it comes back to the difference in the reason why the two types of users use the service. Casual users use it for leisure so they can afford not biking as much in the colder months, however more member users may use this service for commute to work which can be why their numbers don't drop as low.
